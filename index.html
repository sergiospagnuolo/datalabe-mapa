<!DOCTYPE html>
<html>

<head>
    <title>Mapa da Comunicação Comunitária</title>
    <meta charset='utf-8'>
    <script type="text/javascript" src='js/jquery.js '></script>
    <script type="text/javascript" src='js/tabletop1.3.4.js'></script>
    <script type="text/javascript" src='js/sheetsee.js'></script>
    <script type="text/javascript" src='js/leaflet.markercluster.js'></script>
    <link rel="shortcut icon" href="https://raw.github.com/jlord/hack-spots/master/favico.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href='https://api.tiles.mapbox.com/mapbox.js/v1.4.0/mapbox.css' rel='stylesheet' />
    <link href="https://fonts.googleapis.com/css?family=Dosis:400,700|Shadows+Into+Light" rel="stylesheet">
    <link media="screen" rel="stylesheet" type="text/css" href="css/style.css">
    <link media="screen" rel="stylesheet" type="text/css" href="css/site.css">
    <link rel="stylesheet" href="css/MarkerCluster.css" />
    <link rel="stylesheet" href="css/MarkerCluster.Default.css" />
    <script src="https://use.fontawesome.com/ad3531ba27.js"></script>
    
    <!-- METAS -->
    <meta name="author" content="Data_Labe - Observatório de Favelas">
    <meta name="description" content="Mapa da Comunicação Comunitária">
    <meta name="keywords" content="Brasil, comunicação, jornalismo de dados, jornalismo, favelas, comunidade, comunitário">
    <meta name='url' content='http://mapa.datalabe.org'>
    <meta name='coverage' content='Brasil'>
    <meta name='distribution' content='Global'>
    <meta name='rating' content='General'>
    <meta name='subtitle' content='Mapa da Comunicação Comunitária'>
    <meta name='target' content='all'>
    <meta name='HandheldFriendly' content='True'>
    <meta name='MobileOptimized' content='320'>
    <meta property="og:image" content="https://github.com/voltdatalab/datalabe-mapa/blob/gh-pages/main-image_2.png?raw=true" />
    <meta property="og:url" content="http://mapa.datalabe.org">
    <meta property="og:title" content="Mapa da Comunicação Comunitária">
    <meta property="og:description" content="Uma plataforma de georeferenciamento que reúne veículos de comunicação comunitária do Brasil">
    
    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-86293343-1', 'auto');
  ga('send', 'pageview');

</script>
    
    </head>

    <body>
    <div class="wrapper">
        <h1>Mapa da Comunicação Comunitária</h1>
        <div>
            <ul class="nav">
                <li><a href="http://datalabe.org" target="_blank">Um projeto <strong>Data_Labe</strong></a></li>
                <li><a href="http://of.org.br/pt" target="_blank">Observatório de Favelas</a></li>
                <li><a href="#info">Explore</a></li>
                <li><a href="#sobre">Sobre</a></li>
                <li><a href="#colabore">Participe</a></li>
                <li id="social"><a href="http://twitter.com/share?text=Mapa da Comunicação Comunitária, por @data_labe &url=http://mapa.datalabe.org" target="_blank"><i class="fa fa-twitter-square fa-lg" aria-hidden="true"></i></a>&nbsp; <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A//mapa.datalabe.org" target="_blank"><i class="fa fa-facebook-official fa-lg" aria-hidden="true"></i></a>&nbsp; <a href="http://www.medium.com/data-labe" target="_blank"><i class="fa fa-medium fa-lg" aria-hidden="true"></i></a></li>
                
            </ul>
        </div>
        <hr>
       <br>
    </div>
        <div class="wrapper">
    <div class="container-mapa">
        <div id="map"></div>
    </div>
        </div>
    <div class="wrapper">
        <div class="container">
            <div id="rightSide">
                <div id="latestSpot"></div>
                <div id="selectedSpot"></div>
            </div>
        </div>
        <div class="container">
            <span class="noMatches">Não encontramos esse projeto, tente outro!</span> 
            <br><input id="tableFilter" type="text" placeholder="Buscas por nomes, tags, cidades, estados etc."> <span class="clear button">Limpar</span> <span class="resetMap button">Reiniciar Mapa</span> 
            <br>
            <p id="tagging"><span class="category">TAGS:</span>
                <a id="1" class="btn" onclick="reply_click(this)" data-product-name="Comunicação e tecnologia"> Comunicação e tecnologia | </a>
                <a id="2" class="btn" onclick="reply_click(this)" data-product-name="Cultura e Entretenimento">Cultura e Entretenimento | </a>
                <a id="3" class="btn" onclick="reply_click(this)" data-product-name="Economia e negócios">Economia e negócios | </a>
                <a id="4" class="btn" onclick="reply_click(this)" data-product-name="Educação">Educação | </a>
                <a id="5" class="btn" onclick="reply_click(this)" data-product-name="Gênero">Gênero | </a>
                <a id="6" class="btn" onclick="reply_click(this)" data-product-name="Juventude">Juventude | </a>
                <a id="7" class="btn" onclick="reply_click(this)" data-product-name="Meio ambiente">Meio ambiente | </a>
                <a id="8" class="btn" onclick="reply_click(this)" data-product-name="Mobilidade urbana">Mobilidade urbana e Acessibilidade | </a>
                <a id="9" class="btn" onclick="reply_click(this)" data-product-name="Moda e Estética">Moda e Estética | </a>
                <a id="10" class="btn" onclick="reply_click(this)" data-product-name="Notícias locais">Notícias locais | </a>
                <a id="11" class="btn" onclick="reply_click(this)" data-product-name="Política">Política | </a>
                <a id="12" class="btn" onclick="reply_click(this)" data-product-name="Questão racial">Questão racial | </a>
                <a id="13" class="btn" onclick="reply_click(this)" data-product-name="Questão indígena">Questão indígena | </a>
                <a id="14" class="btn" onclick="reply_click(this)" data-product-name="Religião">Religião | </a>
                <a id="15" class="btn" onclick="reply_click(this)" data-product-name="Saúde">Saúde | </a>
                <a id="16" class="btn" onclick="reply_click(this)" data-product-name="Segurança">Segurança</a></p>
            
            
        </div>
        <div id="info" class="container">
            <div id="theNumberofSpots"></div>
            <div id="hackSpotsTable"></div><br><br>
            <h3 id="colabore">Participe</h3>
            <p>Acesse o <a href="https://docs.google.com/forms/d/e/1FAIpQLScsLQ_OYRAkj6CRhxmYJZQaZabaly3zvsiz08eBRUSQf4vAFA/viewform" target="_blank">formulário neste link</a>, adicione seu veículo e participe do mapa.</p>
            <h3>Acesse os dados</h3>
            <p>Formato de <a href="https://docs.google.com/spreadsheets/d/1FVQfK10HV0hQ_4Pjb6A5-iUfeySnzBIvYMRcbK4BvBE/pubhtml" target="_blank">tabela no Google Sheets</a> e <a href="https://raw.githubusercontent.com/voltdatalab/datalabe-mapa/gh-pages/api_datalabe.json" target="_blank">API em Json</a>.</p>
            <h3 id="sobre">Sobre</h3>
            <p>O Mapa da Comunicação Comunitária é uma plataforma de georeferenciamento que reúne veículos de comunicação comunitária do Brasil. Entendemos como veículos de comunicação comunitária aqueles que se caracterizam por processos baseados em princípios públicos, que propiciem a participação ativa da população, que sejam de propriedade coletiva e que não tenham fins lucrativos. </p>
            <p>Nesse mapa, escolhemos abranger aqueles veículos já articulados, produzidos, difundidos ou protagonizados por sujeitos, coletivos e organizações de favelas e outros territórios populares. Excluímos os blogs pessoais, veículos que não produzem conteúdo próprio ou só replicam conteúdo de outros e os que estão inativos.</p>
            <p>A plataforma é colaborativa e qualquer iniciativa que se encaixe nos critérios estabelecidos pode se inscrever e participar do mapa. Utilizamos como ponto de partida a base de dados produzida pelo projeto <a href="http://of.org.br/projetos/comunicacao-projetos/direito-a-comunicacao-e-justica-racial/" target="_blank">Direito à Comunicação e Justiça Racial</a>, realizado em 2014 pelo Observatório de Favelas com o apoio da <a href="https://www.fordfoundation.org/regions/brazil/" target="_blank">Fundação Ford</a>. A partir dela entramos em contato com os veículos, a atualizamos e conseguimos iniciar a plataforma com alguns dos principais veículos de comunicação comunitária do Rio de Janeiro.</p>
            <p>O projeto é um dos produtos do <a href="http://datalabe.org" target="_blank">Data_labe</a>, um laboratório de dados na favela. Acreditamos que o empoderamento da juventude de periferia do Brasil passa, necessariamente, pelo acesso, produção e difusão de informações e hoje a comunicação comunitária é um dos principais responsáveis por garantir esses direitos. Aqui, pretendemos reunir esses veículos, tornar pública a nossa base de dados sobre essas iniciativas e construir um panorama acerca da comunicação comunitária brasileira, contribuindo para a reflexão e elaboração de iniciativas para o setor.</p>
            <p>A plataforma foi desenvolvida pela agência de jornalismo de dados <a href="http://voltdata.info" target="_blank">Volt Data Lab.</a></p>
            <p><span class="red-text category">Acesse, colabore, compartilhe!</span></p>
            <ul class="navdois">
                <li>Siga o Data_Labe:</li>
                <li><a href="http://www.facebook.com/datalabe" target="_blank"><i class="fa fa-facebook-official fa-lg" aria-hidden="true"></i></a>
                    <li><a href="http://www.twitter.com/data_labe" target="_blank"><i class="fa fa-twitter-square fa-lg" aria-hidden="true"></i></a></li>
                    <li><a href="http://www.medium.com/data-labe" target="_blank"><i class="fa fa-medium fa-lg" aria-hidden="true"></i></a></li></ul>
        </div>
    </div>
    <!-- end wrapper -->
    <script id="hackSpotsTable" type="text/html">
        <table>
            <tr>
                <th class="tHeader">Nome</th>
                <th class="tHeader">Cidade</th>
                <th class="tHeader">Fundação</th>
            </tr> {{#rows}}
            <tr id="{{rowNumber}}" class="spotRow">
                <td>{{nome}}</td>
                <td>{{cidade}}</td>
                <td>{{ano}}</td>
            </tr> {{/rows}} </table>
    </script>
    <script id="latestSpot" type="text/html"> {{#rows}}
        <!--<h4 class="fauxButton">Projeto</h4>-->
        <h2>{{nome}}</h2>
        <p class="colorText">{{endereco}}
        </p>
                <p class="colorText">{{cidade}} - {{estado}}</p>
                <ul>
                    <li><span class="category">Ano de fundação:</span> {{ano}}</li>
                    <li><span class="category">Descrição:</span> {{descricao}}</li>
                    <li><span class="category">Site:</span> <a href="{{pagina}}" target="_blank">{{pagina}}</a> </li>
                    <li><span class="category">Email:</span> <a href="mailto:{{email}}">{{email}}</a></li>
                    <li><span class="category">Tema principal:</span> {{tag}}</li>
                    <li><span class="category">Outros assuntos:</span> {{tag2}}</li>
                </ul>
                <ul>
                    <li><a href="http://{{facebook}}" target="_blank"> <i class="fa fa-facebook-official fa-lg" aria-hidden="true"></i></a> &nbsp;&nbsp;
                    <a href="{{twitter}}" target="_blank"> <i class="fa fa-twitter-square fa-lg" aria-hidden="true"></i></a> &nbsp;&nbsp;
                    </li>
                </ul>
                <p>
                    <a href="https://maps.google.com/maps?q={{endereco}},{{cidade}},{{estado}}" target="_blank">Veja no Google Maps</a>
                </p> {{/rows}} </script>
    <script id="theNumberofSpots" type="text/html">
        <h2 id="mapeados"><strong><span class="red-text">{{numberOfSpots}}</span></strong> projetos mapeados!</h2>
    </script>
    <script id="selectedSpot" type="text/html"> {{#rows}}
        <!--<h4 class="fauxButton">Projeto</h4>-->
        <h2>{{nome}}</h2>
        <p class="colorText">{{endereco}}
        </p>
                <p class="colorText">{{cidade}} - {{estado}}</p>
                <ul>
                    <li><span class="category">Ano de fundação:</span> {{ano}}</li>
                    <li><span class="category">Descrição:</span> {{descricao}}</li>
                    <li><span class="category">Site:</span> <a href="http://{{pagina}}" target="_blank">{{pagina}}</a> </li>
                    <li><span class="category">Email:</span> <a href="mailto:{{email}}">{{email}}</a></li>
                    <li><span class="category">Tema principal:</span> {{tag}}</li>
                    <li><span class="category">Outros assuntos:</span> {{tag2}}</li>
                </ul>
                <ul>
                    <li><a href="http://{{facebook}}" target="_blank"><i class="fa fa-facebook-official fa-lg" aria-hidden="true"></i></a> &nbsp;&nbsp;
                    <a href="{{twitter}}" target="_blank"> <i class="fa fa-twitter-square fa-lg" aria-hidden="true"></i></a> &nbsp;&nbsp;
                    </li>
                </ul>
                <p>
                    <a href="https://maps.google.com/maps?q={{endereco}},{{cidade}},{{estado}}" target="_blank">Veja no Google Maps</a>
                </p> {{/rows}} </script>
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
                var gData
                var URL = "https://docs.google.com/spreadsheets/d/1FVQfK10HV0hQ_4Pjb6A5-iUfeySnzBIvYMRcbK4BvBE/pubhtml"
                Tabletop.init({
                    key: URL
                    , callback: showInfo
                    , simpleSheet: true
                })
            })
            // so long, so messy
        function showInfo(gData) {
            tableOptions = {
                    "data": gData
                    , "tableDiv": "#hackSpotsTable"
                    , "filterDiv": "#tableFilter"
                }
                // make the table, and the search bar
            Sheetsee.makeTable(tableOptions)
            Sheetsee.initiateTableFilter(tableOptions)
                // create geoJSON with coordinates and other
                // useful bits from the original data
            var optionsJSON = ["nome", "tag", "rowNumber", "pagina"]
            //"endereco", "estado", "cidade", "email", "pagina", "facebook", "twitter", "instagram", "outra", "ano", "descricao", "secundario"
            var geoJSON = Sheetsee.createGeoJSON(gData, optionsJSON)
                // create map, tilelayer (map background), markers and popups
            var map = Sheetsee.loadMap("map")
            Sheetsee.addTileLayer(map, 'volt.096bgaad')
            var markerLayer = Sheetsee.addMarkerLayer(geoJSON, map, "<a href='http://{{pagina}}' target='_blank'><h2> {{ nome }} </h2></a>", true)
                // find the latest spot with the most important
                // info filled in (to prevent map breaking if
                // someone is currently editing spreadsheet)
            var theLatestSpot = findLatestCompleteSpot(gData)
            var latestSpot = Sheetsee.ich.latestSpot({
                    rows: theLatestSpot
                })
            
                // set it and pan to it
            $('#latestSpot').html(latestSpot)
            map.setView([theLatestSpot.lat, theLatestSpot.long], 10)
                // when someone clicks on a row, highlight it and
                // re-center the map
                // TODO show popup, change marker color
            $('.spotRow').live("click", function (event) {
                    $('.spotRow').removeClass("selectedRow")
                    var rowNumber = $(this).closest("tr").attr("id")
                    $('#' + rowNumber).addClass("selectedRow")
                    var dataElement = Sheetsee.getMatches(gData, rowNumber, "rowNumber")
                    var selectedSpot = Sheetsee.ich.selectedSpot({
                        rows: dataElement
                    })
                    $('#latestSpot').css("display", "none")
                    $('#selectedSpot').html(selectedSpot).css("display", "inline")
                    var selectedCoords = [dataElement[0].lat, dataElement[0].long]
                    map.setView(selectedCoords, 17)
                })
                // so that the first map and info that loads
                // is complete and doesn't show rows that are
                // actively being edited by folk
            function findLatestCompleteSpot(data) {
                var latestCompleteSpot = []
                var startWithLatestRow = data.reverse()
                startWithLatestRow.forEach(function (row) {
                    if (!row.lat || !row.long || !row.nome || !row.endereco || !row.cidade || !row.estado  || !row.descricao || !row.tag ) return
                    else latestCompleteSpot.push(row)
                })
                return latestCompleteSpot[0]
            }
            // Add click listener to the markerLayer
            markerLayer.on('click', function (e) {
                    // clear any selected rows
                    $('.spotRow').removeClass("selectedRow")
                        // get row number of selected marker
                    var rowNumber = e.layer.feature.opts.rowNumber
                        // find that row in the table and make consider it selected
                    $('#' + rowNumber).addClass("selectedRow")
                        // using row number, get the data for the selected spot
                    var dataElement = Sheetsee.getMatches(gData, rowNumber.toString(), "rowNumber")
                        // take those details and re-write the selected spot section
                    var selectedSpot = Sheetsee.ich.selectedSpot({
                            rows: dataElement
                        })        
            
                        // center the map on the selected element
                    map.panTo([dataElement[0].lat, dataElement[0].long])
                        // update the spot listing
                    $('#latestSpot').css("display", "none")
                    $('#selectedSpot').html(selectedSpot).css("display", "inline") 
                })
                // reset the map, zoom out, and recenter on 0,0
            $('.resetMap').click(function () {
                    $('.spotRow').removeClass("selectedRow")
                    $('#latestSpot').css("display", "inline")
                    $('#selectedSpot').css("display", "none")
                    map.setView([-22.9211744, -43.1781256], 4)
                })
                // find total number of spots added
            var theNumberofSpots = Sheetsee.ich.theNumberofSpots({
                numberOfSpots: gData.length
            })
            $('#theNumberofSpots').html(theNumberofSpots)
            if (window.location.hash) {
                $('#tableFilter').val(window.location.hash.substring(1)).keyup()
                $('.spotRow').first().click()
            }
        }
        $(document).on('keyup', '#tableFilter', function () {
            window.location.hash = $(this).val()
            $('.spotRow').first().click()
        })
    </script>
    
    <script type="text/javascript">
    
    function reply_click(element)
    {
    document.getElementById('tableFilter').value = element.getAttribute('data-product-name');
    }    
    
</script>
<script>
    $(function() {
  $('a[href*="#"]:not([href="#"])').click(function() {
    if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
      var target = $(this.hash);
      target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
      if (target.length) {
        $('html, body').animate({
          scrollTop: target.offset().top
        }, 1000);
        return false;
      }
    }
  });
});</script>
        
</body>

</html>
